#!/bin/bash

# =================== Export =====================

if (which vim &>/dev/null); then           # Set vim as default editor.
  export VISUAL='vim'
fi

export LANG='POSIX'                        # Use posix encoding for console output.
export LS_COLORS='di=0;36:ln=1;35'         # Set colors for ls command (directory and symbolic link).

# =================== General ==================

bind 'set bell-style none'                 # Disable terminal bell.
shopt -s autocd                            # Change directory without using cd. 

# =================== Alias ====================

alias ls='ls --color'                      # Add colors to list directory contents command (colors are based on LS_COLORS).
alias ll='ls -l'                           # List files in the long format.
alias l='ls -la'                           # List files in the long format and include directory entries whose names begin with a dot (‘.’).

alias c='clear'

if (which vim &>/dev/null); then
  alias vi='vim'
fi

if (which git &>/dev/null); then
  alias s='git status'
fi

if (which htop &>/dev/null); then
  alias top='htop'
fi

if (which tree &>/dev/null); then          # Add colors to tree command.
  alias tree='tree -C'
fi

if (test -r ~/.aliases); then              # Source additional aliases.
  source ~/.aliases
fi

# =================== Git branch ===============

if (which git &>/dev/null); then
  parse_git_branch() { git branch 2> /dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/(\1) /'; }
else
  parse_git_branch() { :; }
fi

# =================== Prompt ===================

PROMPT_DIRTRIM=2                           # Number of trailing directories to retian when expanding the 'w' and 'W' prompt string escapes.

nocolor="\[\e[0m\]"                        # All attributes off.
green="\[\e[0;32m\]"                       # Regular green frontground color.
yellow="\[\e[0;33m\]"                      # Regular yellow frontground color.
cyan="\[\e[0;36m\]"                        # Regular cyan frontground color.

open_brk="${nocolor}["                     # The '[' bracket.
closed_brk="${nocolor}]"                   # The ']' bracket.
username="${green}\u"                      # The username of the current user.
at="${nocolor}@"                           # The '@' sign.
hostname="${nocolor}\h"                    # The hostname up to the first `.'
working_dir="${cyan}\w"                    # The current working directory, with $HOME abbreviated with a tilde (uses the value of the PROMPT_DIRTRIM variable).
git_branch="${yellow}\$(parse_git_branch)" # The current git branch.
prompt_indicator="${nocolor}\$"            # A '#' if the shell is running with privileges, a '$' if not.

PS1="${open_brk}${username}${at}${hostname} ${working_dir} ${git_branch}${closed_brk}${prompt_indicator}${nocolor} "
